package code.blurone.snifferexploited

import org.bukkit.configuration.ConfigurationSection
import org.bukkit.entity.EntityType
import org.bukkit.entity.Player
import org.bukkit.event.EventHandler
import org.bukkit.event.Listener
import org.bukkit.event.entity.EntityPickupItemEvent
import org.bukkit.inventory.meta.SkullMeta

class OcdTranslator(private val snoutTranslations: ConfigurationSection, private val loreTranslations: ConfigurationSection) : Listener {
    @EventHandler
    fun ocdTranslator(event: EntityPickupItemEvent)
    {
        if (event.entity.type != EntityType.PLAYER ||
            !isSnout(event.item.itemStack))
            return

        val strippedLocale: String = (event.entity as Player).locale.split("_")[0]
        val meta = event.item.itemStack.itemMeta as SkullMeta
        meta.setDisplayName(snoutTranslations.getString(strippedLocale, defaultSnoutName))
        if (showLore)
            meta.lore = listOf(loreTranslations.getString(strippedLocale, defaultLore))
        event.item.itemStack.itemMeta = meta
    }
}