package code.blurone.snifferexploited.commands

import code.blurone.snifferexploited.PotionOfSniffing
import org.bukkit.command.*
import org.bukkit.entity.Player

class SniffCommandExecutor(private val feature: PotionOfSniffing) : TabExecutor {
    override fun onCommand(
        sender: CommandSender,
        command: Command,
        label: String,
        args: Array<out String>
    ): Boolean {
        if (sender !is Player) {
            sender.sendMessage("You must be a player to use this command")
            return true
        }

        if (args.isEmpty())
        {
            feature.scanForOres(sender)
            return true
        }
        else if (args.size != 2)
            return false

        val duration = args[0].toDoubleOrNull()
        val radius = args[1].toIntOrNull()

        if (duration == null || radius == null)
            return false

        feature.scanForOres(sender, radius, duration)

        return true
    }

    override fun onTabComplete(
        sender: CommandSender,
        command: Command,
        label: String,
        args: Array<out String>
    ): MutableList<String> {
        return when (args.size)
        {
            1 -> mutableListOf("<duration>")
            2 -> mutableListOf("<radius>")
            else -> mutableListOf()
        }
    }
}